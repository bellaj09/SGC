Animals acquire behaviors through instrumental conditioning. Brain-machine interfaces have used instrumental conditioning to reinforce patterns of neural activity directly especially in frontal and motor cortices which are a rich source of signals for voluntary action. However evidence suggests that activity in primary sensory cortices may also reflect internally driven processes instead of purely encoding antecedent stimuli. Here we show that rats and mice can learn to produce arbitrary patterns of neural activity in their primary visual cortex to control an auditory cursor and obtain reward. Furthermore learning was prevented when neurons in the dorsomedial striatum DMS which receives input from visual cortex were optogenetically inhibited but not during inhibition of nearby neurons in the dorsolateral striatum. After learning DMS inhibition did not affect production of the rewarded patterns. These data demonstrate that cortico-basal ganglia circuits play a general role in learning to produce cortical activity that leads to desirable outcomes. Volitional Modulation of Primary Visual Cortex Activity Requires the Basal Ganglia.