An important property of visual systems is to be simultaneously both selective to specific patterns found in the sensory input and invariant to possible variations. Selectivity and invariance tolerance are opposing requirements. It has been suggested that they could be joined by iterating a sequence of elementary selectivity and tolerance computations. It is however unknown what should be selected or tolerated at each level of the hierarchy. We approach this issue by learning the computations from natural images. We propose and estimate a probabilistic model of natural images that consists of three processing layers. Two natural image data sets are considered: image patches and complete visual scenes downsampled to the size of small patches. For both data sets we find that in the first two layers simple and complex cell-like computations are performed. In the third layer we mainly find selectivity to longer contours; for patch data we further find some selectivity to texture while for the downsampled complete scenes some selectivity to curvature is observed. A three-layer model of natural image statistics.