We address two shortcomings of the common spatial patterns CSP algorithm for spatial filtering in the context of brain--computer interfaces BCIs based on electroencephalography/magnetoencephalography EEG/MEG: First the question of optimality of CSP in terms of the minimal achievable classification error remains unsolved. Second CSP has been initially proposed for two-class paradigms. Extensions to multiclass paradigms have been suggested but are based on heuristics. We address these shortcomings in the framework of information theoretic feature extraction ITFE. We show that for two-class paradigms CSP maximizes an approximation of mutual information of extracted EEG/MEG components and class labels. This establishes a link between CSP and the minimal classification error. For multiclass paradigms we point out that CSP by joint approximate diagonalization JAD is equivalent to independent component analysis ICA and provide a method to choose those independent components ICs that approximately maximize mutual information of ICs and class labels. This eliminates the need for heuristics in multiclass CSP and allows incorporating prior class probabilities. The proposed method is applied to the dataset IIIa of the third BCI competition and is shown to increase the mean classification accuracy by 23.4% in comparison to multiclass CSP. Multiclass common spatial patterns and information theoretic feature extraction.