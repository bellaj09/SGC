Technical advances in the field of Brain-Machine Interfaces BMIs enable users to control a variety of external devices such as robotic arms wheelchairs virtual entities and communication systems through the decoding of brain signals in real time. Most BMI systems sample activity from restricted brain regions typically the motor and premotor cortex with limited spatial resolution. Despite the growing number of applications the cortical and subcortical systems involved in BMI control are currently unknown at the whole-brain level. Here we provide a comprehensive and detailed report of the areas active during on-line BMI control. We recorded functional magnetic resonance imaging fMRI data while participants controlled an EEG-based BMI inside the scanner. We identified the regions activated during BMI control and how they overlap with those involved in motor imagery without any BMI control. In addition we investigated which regions reflect the subjective sense of controlling a BMI the sense of agency for BMI-actions. Our data revealed an extended cortical-subcortical network involved in operating a motor-imagery BMI. This includes not only sensorimotor regions but also the posterior parietal cortex the insula and the lateral occipital cortex. Interestingly the basal ganglia and the anterior cingulate cortex were involved in the subjective sense of controlling the BMI. These results inform basic neuroscience by showing that the mechanisms of BMI control extend beyond sensorimotor cortices. This knowledge may be useful for the development of BMIs that offer a more natural and embodied feeling of control for the user. Hum Brain Mapp 38:2971-2989 2017. Cortical and subcortical mechanisms of brain-machine interfaces.