Learning from a few examples and generalizing to markedly different situations are capabilities of human visual intelligence that are yet to be matched by leading machine learning models. By drawing inspiration from systems neuroscience we introduce a probabilistic generative model for vision in which message-passing-based inference handles recognition segmentation and reasoning in a unified way. The model demonstrates excellent generalization and occlusion-reasoning capabilities and outperforms deep neural networks on a challenging scene text recognition benchmark while being 300-fold more data efficient. In addition the model fundamentally breaks the defense of modern text-based CAPTCHAs Completely Automated Public Turing test to tell Computers and Humans Apart by generatively segmenting characters without CAPTCHA-specific heuristics. Our model emphasizes aspects such as data efficiency and compositionality that may be important in the path toward general artificial intelligence. A generative vision model that trains with high data efficiency and breaks text-based CAPTCHAs.