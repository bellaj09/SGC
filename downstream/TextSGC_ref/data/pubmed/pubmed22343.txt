This paper presents a new approach for implementation of closed-loop brain-machine interface algorithms by combining optogenetic neural stimulation with electrocorticography and fluorescence microscopy. We used a new generation of microfabricated electrocorticography micro-ECoG devices in which electrode arrays are embedded within an optically transparent biocompatible substrate that provides optical access to the brain tissue during electrophysiology recording. An optical setup was designed capable of projecting arbitrary patterns of light for optogenetic stimulation and performing fluorescence microscopy through the implant. For realization of a closed-loop system using this platform the feedback can be taken from electrophysiology data or fluorescence imaging. In the closed-loop systems discussed in this paper the feedback signal was taken from the micro-ECoG. In these algorithms the electrophysiology data are continuously transferred to a computer and compared with some predefined spatial-temporal patterns of neural activity. The computer which processes the data also readjusts the duration and distribution of optogenetic stimulating pulses to minimize the difference between the recorded activity and the predefined set points so that after a limited period of transient response the recorded activity follows the set points. Details of the system design and implementation of typical closed-loop paradigms are discussed in this paper. Closed-Loop Optogenetic Brain Interface.