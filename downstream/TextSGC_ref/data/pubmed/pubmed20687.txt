This paper presents a bidirectional brain machine interface BMI microsystem designed for closed-loop neuroscience research especially experiments in freely behaving animals. The system-on-chip SoC consists of 16-channel neural recording front-ends neural feature extraction units 16-channel programmable neural stimulator back-ends in-channel programmable closed-loop controllers global analog-digital converters ADC and peripheral circuits. The proposed neural feature extraction units includes 1 an ultra low-power neural energy extraction unit enabling a 64-step natural logarithmic domain frequency tuning and 2 a current-mode action potential AP detection unit with time-amplitude window discriminator. A programmable proportional-integral-derivative PID controller has been integrated in each channel enabling a various of closed-loop operations. The implemented ADCs include a 10-bit voltage-mode successive approximation register SAR ADC for the digitization of the neural feature outputs and/or local field potential LFP outputs and an 8-bit current-mode SAR ADC for the digitization of the action potential outputs. The multi-mode stimulator can be programmed to perform monopolar or bipolar symmetrical or asymmetrical charge balanced stimulation with a maximum current of 4 mA in an arbitrary channel configuration. The chip has been fabricated in 0.18  m CMOS technology occupying a silicon area of 3.7 mm 2. The chip dissipates 56 W/ch on average. General purpose low-power microcontroller with Bluetooth module are integrated in the system to provide wireless link and SoC configuration. Methods circuit techniques and system topology proposed in this work can be used in a wide range of relevant neurophysiology research especially closed-loop BMI experiments. Design of a Closed-Loop Bidirectional Brain Machine Interface System With Energy Efficient Neural Feature Extraction and PID Control.