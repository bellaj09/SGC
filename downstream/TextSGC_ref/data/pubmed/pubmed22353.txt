"Working memory is a key executive function for flying an aircraft. This function is particularly critical when pilots have to recall series of air traffic control instructions. However working memory limitations may jeopardize flight safety. Since the functional near-infrared spectroscopy fNIRS method seems promising for assessing working memory load our objective is to implement an on-line fNIRS-based inference system that integrates two complementary estimators. The first estimator is a real-time state estimation MACD-based algorithm dedicated to identifying the pilots instantaneous mental state not-on-task vs. on-task. It does not require a calibration process to perform its estimation. The second estimator is an on-line SVM-based classifier that is able to discriminate task difficulty low working memory load vs. high working memory load. These two estimators were tested with 19 pilots who were placed in a realistic flight simulator and were asked to recall air traffic control instructions. We found that the estimated pilots mental state matched significantly better than chance with the pilots real state 62% global accuracy 58% specificity and 72% sensitivity. The second estimator dedicated to assessing single trial working memory loads led to 80% classification accuracy 72% specificity and 89% sensitivity. These two estimators establish reusable blocks for further fNIRS-based passive brain computer interface development." Real-time state estimation in a flight simulator using fNIRS.